# 项目部署指南

本指南将帮助您将《红楼梦》薛寶釵社交网络分析项目部署到线上。

## 📋 部署前检查清单

在开始部署之前，请确保：

- [x] ✅ 代码已推送到GitHub仓库
- [x] ✅ `requirements.txt` 文件存在且包含所有依赖
- [x] ✅ `4_streamlit_app.py` 文件存在
- [x] ✅ `data/` 目录及其所有文件已推送到GitHub（约4.1MB，可以直接推送）
- [x] ✅ 项目结构完整

---

## 🚀 方法一：Streamlit Cloud（推荐，最简单）

Streamlit Cloud是Streamlit官方提供的免费托管服务，**强烈推荐**使用此方法。

### 优点：
- ✅ 完全免费
- ✅ 设置简单，几分钟即可完成
- ✅ 自动部署（每次推送到main分支会自动重新部署）
- ✅ 无需服务器管理
- ✅ 官方支持，稳定可靠

### 部署步骤：

#### 1. 访问Streamlit Cloud
打开浏览器，访问：**https://share.streamlit.io/**

#### 2. 登录账号
- 点击 "Sign in" 按钮
- 使用您的 **GitHub账号** 登录
- 授权Streamlit Cloud访问您的GitHub仓库

#### 3. 创建新应用
- 点击页面上的 **"New app"** 按钮
- 或者点击右上角的 **"Deploy an app"**

#### 4. 配置应用
在部署配置页面，填写以下信息：

- **Repository（仓库）**: 选择您的GitHub仓库
  - 例如：`your-username/CHC5904_HongLouMeng`

- **Branch（分支）**: 选择 `main` 或 `master`

- **Main file path（主文件路径）**: 
  ```
  4_streamlit_app.py
  ```

- **Python version（Python版本）**: 
  - 选择 `3.9` 或更高版本（推荐 `3.9` 或 `3.10`）

- **Advanced settings（高级设置）**（可选）:
  - 如果需要，可以设置环境变量
  - 本项目通常不需要额外配置

#### 5. 部署应用
- 点击 **"Deploy"** 按钮
- 等待部署完成（首次部署可能需要3-5分钟）

#### 6. 访问应用
部署完成后，您将获得一个公开URL，格式如下：
```
https://your-app-name.streamlit.app
```

例如：
```
https://hongloumeng-xuebaochai.streamlit.app
```

### 部署后操作：

1. **自动更新**：
   - 每次您推送到GitHub的main分支，应用会自动重新部署
   - 无需手动操作

2. **查看日志**：
   - 在Streamlit Cloud控制台可以查看应用日志
   - 如果部署失败，可以查看错误信息

3. **管理应用**：
   - 可以暂停、重启或删除应用
   - 可以设置应用为私有（需要付费计划）

---

## 🐳 方法二：Docker部署（适用于VPS或云服务器）

如果您有自己的服务器或VPS，可以使用Docker部署。

### 前提条件：
- 已安装Docker和Docker Compose
- 有可访问的服务器（VPS、云服务器等）

### 部署步骤：

#### 1. 在服务器上克隆仓库
```bash
git clone https://github.com/your-username/CHC5904_HongLouMeng.git
cd CHC5904_HongLouMeng
```

#### 2. 构建Docker镜像
```bash
docker build -t hongloumeng-app .
```

#### 3. 运行容器
```bash
docker run -d -p 8501:8501 --name hongloumeng-app hongloumeng-app
```

#### 4. 访问应用
打开浏览器访问：`http://your-server-ip:8501`

### 使用Docker Compose（推荐）

创建 `docker-compose.yml` 文件：
```yaml
version: '3.8'

services:
  streamlit:
    build: .
    ports:
      - "8501:8501"
    restart: unless-stopped
```

然后运行：
```bash
docker-compose up -d
```

---

## ☁️ 方法三：Heroku部署

### 前提条件：
- 已安装Heroku CLI
- 已创建Heroku账号

### 部署步骤：

#### 1. 登录Heroku
```bash
heroku login
```

#### 2. 创建应用
```bash
heroku create your-app-name
```

#### 3. 部署
```bash
git push heroku main
```

#### 4. 访问应用
```bash
heroku open
```

**注意**：Heroku的免费计划已经停止，现在需要付费使用。

---

## 🔧 方法四：本地部署（用于测试）

如果您只想在本地运行应用进行测试：

### 步骤：

#### 1. 安装依赖
```bash
pip install -r requirements.txt
```

#### 2. 运行应用
```bash
streamlit run 4_streamlit_app.py
```

#### 3. 访问应用
浏览器会自动打开，或手动访问：`http://localhost:8501`

---

## 📝 常见问题排查

### 1. 部署失败 - 找不到文件
**问题**：应用启动时提示找不到数据文件

**解决方案**：
- 确保 `data/` 目录及其所有文件都已推送到GitHub
- 检查文件路径是否正确（相对路径）

### 2. 依赖安装失败
**问题**：某些Python包无法安装

**解决方案**：
- 检查 `requirements.txt` 中的包版本是否兼容
- 确保Python版本为3.9或更高

### 3. 应用运行缓慢
**问题**：应用加载或运行很慢

**解决方案**：
- Streamlit Cloud免费版有资源限制
- 考虑优化代码，使用 `@st.cache_data` 缓存数据
- 如果数据文件很大，考虑使用Git LFS

### 4. 中文显示问题
**问题**：图表中的中文无法正常显示

**解决方案**：
- 代码中已配置中文字体（SimHei, Arial Unicode MS）
- 如果仍有问题，检查系统是否支持中文字体

---

## 🎯 推荐方案总结

| 部署方式 | 难度 | 成本 | 推荐度 |
|---------|------|------|--------|
| **Streamlit Cloud** | ⭐ 简单 | 免费 | ⭐⭐⭐⭐⭐ |
| Docker部署 | ⭐⭐⭐ 中等 | 需服务器 | ⭐⭐⭐ |
| Heroku | ⭐⭐ 简单 | 付费 | ⭐⭐ |
| 本地部署 | ⭐ 简单 | 免费 | ⭐⭐⭐（仅测试） |

**强烈推荐使用Streamlit Cloud**，因为：
- 最简单快捷
- 完全免费
- 自动部署
- 无需维护

---

## 📞 需要帮助？

如果部署过程中遇到问题：

1. 查看Streamlit Cloud的日志输出
2. 检查GitHub仓库中的文件是否完整
3. 参考官方文档：https://docs.streamlit.io/streamlit-cloud

---

## ✅ 部署检查清单

部署完成后，请检查：

- [ ] 应用可以正常访问
- [ ] 数据可以正常加载
- [ ] 图表可以正常显示
- [ ] 交互功能正常工作
- [ ] 中文显示正常
- [ ] 网络可视化可以正常显示

祝您部署顺利！🎉

